{"version":3,"file":"wallet_activation.min.js","sources":["../src/wallet_activation.js"],"sourcesContent":["// This file is part of the Paynocchio payments module for Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Paynocchio repository module to encapsulate all of the AJAX requests that can be sent for bank.\r\n *\r\n * @module     paygw_paynocchio/repository\r\n * @copyright  2024 Paynocchio <ceo@paynocchio.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport {handleWalletActivationClick} from \"./repository\";\r\n\r\nexport const init = (user_id) => {\r\n    const paynocchio_activation_button = document.getElementById('paynocchio_activation_button');\r\n\r\n    if(paynocchio_activation_button) {\r\n        const spinner = paynocchio_activation_button.querySelector('.paynocchio-spinner');\r\n        const message = document.querySelector('.topup-description');\r\n        paynocchio_activation_button.addEventListener('click', () => {\r\n            paynocchio_activation_button.classList.add('disabled');\r\n            const response = handleWalletActivationClick(user_id);\r\n            spinner.classList.add('active');\r\n            response.then(data => {\r\n                if(data.success) {\r\n                    spinner.classList.remove('active');\r\n                    message.classList.remove('hidden');\r\n\r\n                    document.getElementById('congratz').classList.add('shown');\r\n\r\n                    let $i = 5;\r\n                    let $interval = setInterval(function() {\r\n                            if (--$i === 1) {\r\n                                clearInterval($interval);\r\n                            }\r\n                            document.getElementById('congratz_countdown').innerHTML = $i + '';\r\n                        }, 1000);\r\n\r\n                    let delay = 5000;\r\n                    setTimeout(function() {\r\n                        document.getElementById('congratz_countdown').classList.add('paynocchio-hidden');\r\n                        window.location.reload();\r\n                    }, delay);\r\n                    document.getElementById('card_number').innerText = data.card_number;\r\n                    if (document.getElementById('page-payment-gateway-paynocchio-pay')) {\r\n                        document.getElementById('page-payment-gateway-paynocchio-pay').style.overflow = 'hidden';\r\n                    }\r\n                    if (document.getElementById('page-payment-gateway-paynocchio-my_paynocchio_wallet')) {\r\n                        document.getElementById('page-payment-gateway-paynocchio-my_paynocchio_wallet').style.overflow = 'hidden';\r\n                    }\r\n                } else {\r\n                    window.console.log(data);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    const paynocchio_congratz_button = document.getElementById('paynocchio_congratz_button');\r\n    if(paynocchio_congratz_button) {\r\n        paynocchio_congratz_button.onclick = function () {\r\n            document.getElementById('congratz_spinner').classList.add('shown');\r\n            window.location.reload();\r\n        };\r\n    }\r\n};"],"names":["_exports","init","user_id","paynocchio_activation_button","document","getElementById","spinner","querySelector","message","addEventListener","classList","add","response","handleWalletActivationClick","then","data","success","remove","$i","$interval","setInterval","clearInterval","innerHTML","setTimeout","window","location","reload","innerText","card_number","style","overflow","console","log","paynocchio_congratz_button","onclick"],"mappings":"oLA4EEA,SAAAC,KAnDmBC,UACjB,MAAMC,6BAA+BC,SAASC,eAAe,gCAE7D,GAAGF,6BAA8B,CAC7B,MAAMG,QAAUH,6BAA6BI,cAAc,uBACrDC,QAAUJ,SAASG,cAAc,sBACvCJ,6BAA6BM,iBAAiB,SAAS,KACnDN,6BAA6BO,UAAUC,IAAI,YAC3C,MAAMC,UAAW,EAAAC,yCAA4BX,SAC7CI,QAAQI,UAAUC,IAAI,UACtBC,SAASE,MAAKC,OACV,GAAGA,KAAKC,QAAS,CACbV,QAAQI,UAAUO,OAAO,UACzBT,QAAQE,UAAUO,OAAO,UAEzBb,SAASC,eAAe,YAAYK,UAAUC,IAAI,SAElD,IAAIO,GAAK,EACLC,UAAYC,aAAY,WACP,KAAPF,IACFG,cAAcF,WAElBf,SAASC,eAAe,sBAAsBiB,UAAYJ,GAAK,KAChE,KAGPK,YAAW,WACPnB,SAASC,eAAe,sBAAsBK,UAAUC,IAAI,qBAC5Da,OAAOC,SAASC,WAHR,KAKZtB,SAASC,eAAe,eAAesB,UAAYZ,KAAKa,YACpDxB,SAASC,eAAe,yCACxBD,SAASC,eAAe,uCAAuCwB,MAAMC,SAAW,UAEhF1B,SAASC,eAAe,0DACxBD,SAASC,eAAe,wDAAwDwB,MAAMC,SAAW,eAGrGN,OAAOO,QAAQC,IAAIjB,QAEzB,IAIV,MAAMkB,2BAA6B7B,SAASC,eAAe,8BACxD4B,6BACCA,2BAA2BC,QAAU,WACjC9B,SAASC,eAAe,oBAAoBK,UAAUC,IAAI,SAC1Da,OAAOC,SAASC,WAG1B"}