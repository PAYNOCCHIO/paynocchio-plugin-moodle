{"version":3,"file":"wallet_activation.min.js","sources":["../src/wallet_activation.js"],"sourcesContent":["// This file is part of the Paynocchio payments module for Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Paynocchio repository module to encapsulate all of the AJAX requests that can be sent for bank.\n *\n * @module     paygw_paynocchio/repository\n * @copyright  2024 Paynocchio <ceo@paynocchio.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {handleTopUpClick, handleWalletActivationClick} from \"./repository\";\nimport Templates from 'core/templates';\nimport Modal from 'core/modal';\n\n/**\n * Creates and shows a modal that contains a placeholder.\n *\n * @returns {Promise<Modal>}\n */\nconst showModalWithTopup = async() => await Modal.create({\n    body: await Templates.render('paygw_paynocchio/topup_modal', {}),\n    show: true,\n    removeOnClose: true,\n});\n\nexport const init = (user_id) => {\n    const paynocchio_activation_button = document.getElementById('paynocchio_activation_button');\n\n    if(paynocchio_activation_button) {\n        const spinner = paynocchio_activation_button.querySelector('.paynocchio-spinner');\n        paynocchio_activation_button.addEventListener('click', () => {\n            const response = handleWalletActivationClick(user_id);\n            spinner.classList.add('active');\n            response.then(data => {\n                if(data.success) {\n                    spinner.classList.remove('active');\n                }\n            });\n        });\n    }\n\n    const paynocchio_wallet_topup_button = document.getElementById('paynocchio_topup_button');\n\n    if(paynocchio_wallet_topup_button) {\n        paynocchio_wallet_topup_button.addEventListener('click', () => {\n            showModalWithTopup()\n                .then(modal => {\n                    const input = modal.body.find('#top_up_amount');\n                    const button = modal.body.find('#topup_button');\n                    button.click(()=> {\n                        if(input.val()) {\n                            handleTopUpClick(input.val())\n                                .then(data => window.console.log(data));\n                        }\n                    });\n                });\n        });\n\n    }\n\n};\n"],"names":["user_id","paynocchio_activation_button","document","getElementById","spinner","querySelector","addEventListener","response","classList","add","then","data","success","remove","paynocchio_wallet_topup_button","async","Modal","create","body","Templates","render","show","removeOnClose","showModalWithTopup","modal","input","find","click","val","window","console","log"],"mappings":";;;;;;;oLAsCqBA,gBACXC,6BAA+BC,SAASC,eAAe,mCAE1DF,6BAA8B,OACvBG,QAAUH,6BAA6BI,cAAc,uBAC3DJ,6BAA6BK,iBAAiB,SAAS,WAC7CC,UAAW,2CAA4BP,SAC7CI,QAAQI,UAAUC,IAAI,UACtBF,SAASG,MAAKC,OACPA,KAAKC,SACJR,QAAQI,UAAUK,OAAO,sBAMnCC,+BAAiCZ,SAASC,eAAe,2BAE5DW,gCACCA,+BAA+BR,iBAAiB,SAAS,KAzBtCS,gBAAiBC,eAAMC,OAAO,CACrDC,WAAYC,mBAAUC,OAAO,+BAAgC,IAC7DC,MAAM,EACNC,eAAe,IAuBPC,GACKb,MAAKc,cACIC,MAAQD,MAAMN,KAAKQ,KAAK,kBACfF,MAAMN,KAAKQ,KAAK,iBACxBC,OAAM,KACNF,MAAMG,wCACYH,MAAMG,OAClBlB,MAAKC,MAAQkB,OAAOC,QAAQC,IAAIpB"}