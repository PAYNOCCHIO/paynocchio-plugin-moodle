{"version":3,"file":"wallet_activation.min.js","sources":["../src/wallet_activation.js"],"sourcesContent":["// This file is part of the Paynocchio payments module for Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Paynocchio repository module to encapsulate all of the AJAX requests that can be sent for bank.\n *\n * @module     paygw_paynocchio/repository\n * @copyright  2024 Paynocchio <ceo@paynocchio.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {handleWalletActivationClick} from \"./repository\";\n\nexport const init = (user_id) => {\n    const paynocchio_activation_button = document.getElementById('paynocchio_activation_button');\n\n    if(paynocchio_activation_button) {\n        const spinner = paynocchio_activation_button.querySelector('.paynocchio-spinner');\n        const message = document.querySelector('.topup-description');\n        paynocchio_activation_button.addEventListener('click', () => {\n            paynocchio_activation_button.classList.add('disabled');\n            const response = handleWalletActivationClick(user_id);\n            spinner.classList.add('active');\n            response.then(data => {\n                if(data.success) {\n                    spinner.classList.remove('active');\n                    message.classList.remove('hidden');\n\n                    document.getElementById('congratz').classList.add('shown');\n                    let delay = 5000;\n                    setTimeout(function() {\n                        window.location.reload();\n                    }, delay);\n                    document.getElementById('card_number').innerText = data.card_number;\n                    if (document.getElementById('page-payment-gateway-paynocchio-pay')) {\n                        document.getElementById('page-payment-gateway-paynocchio-pay').style.overflow = 'hidden';\n                    }\n                    if (document.getElementById('page-payment-gateway-paynocchio-my_paynocchio_wallet')) {\n                        document.getElementById('page-payment-gateway-paynocchio-my_paynocchio_wallet').style.overflow = 'hidden';\n                    }\n                } else {\n                    window.console.log(data);\n                }\n            });\n        });\n    }\n\n    const paynocchio_congratz_button = document.getElementById('paynocchio_congratz_button');\n    if(paynocchio_congratz_button) {\n        paynocchio_congratz_button.onclick = function () {\n            document.getElementById('congratz_spinner').classList.add('shown');\n            window.location.reload();\n        };\n    }\n};"],"names":["user_id","paynocchio_activation_button","document","getElementById","spinner","querySelector","message","addEventListener","classList","add","response","then","data","success","remove","setTimeout","window","location","reload","innerText","card_number","style","overflow","console","log","paynocchio_congratz_button","onclick"],"mappings":"kMAyBqBA,gBACXC,6BAA+BC,SAASC,eAAe,mCAE1DF,6BAA8B,OACvBG,QAAUH,6BAA6BI,cAAc,uBACrDC,QAAUJ,SAASG,cAAc,sBACvCJ,6BAA6BM,iBAAiB,SAAS,KACnDN,6BAA6BO,UAAUC,IAAI,kBACrCC,UAAW,2CAA4BV,SAC7CI,QAAQI,UAAUC,IAAI,UACtBC,SAASC,MAAKC,UACPA,KAAKC,QAAS,CACbT,QAAQI,UAAUM,OAAO,UACzBR,QAAQE,UAAUM,OAAO,UAEzBZ,SAASC,eAAe,YAAYK,UAAUC,IAAI,SAElDM,YAAW,WACPC,OAAOC,SAASC,WAFR,KAIZhB,SAASC,eAAe,eAAegB,UAAYP,KAAKQ,YACpDlB,SAASC,eAAe,yCACxBD,SAASC,eAAe,uCAAuCkB,MAAMC,SAAW,UAEhFpB,SAASC,eAAe,0DACxBD,SAASC,eAAe,wDAAwDkB,MAAMC,SAAW,eAGrGN,OAAOO,QAAQC,IAAIZ,kBAM7Ba,2BAA6BvB,SAASC,eAAe,8BACxDsB,6BACCA,2BAA2BC,QAAU,WACjCxB,SAASC,eAAe,oBAAoBK,UAAUC,IAAI,SAC1DO,OAAOC,SAASC"}