define("paygw_paynocchio/wallet_topup",["exports","./repository"],(function(_exports,_repository){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=pay=>{const paynocchio_wallet_topup_button=document.getElementById("paynocchio_topup_button");let need_to_top_up=0;pay&&document.getElementById("need_to_top_up")&&(need_to_top_up=parseFloat(document.getElementById("need_to_top_up").innerText)),paynocchio_wallet_topup_button&&paynocchio_wallet_topup_button.addEventListener("click",(()=>{(0,_repository.showModalWithTopup)().then((modal=>{modal.setTitle("Topup your Wallet");const input=modal.body.find("#top_up_amount"),message=modal.body.find("#topup_message");pay&&need_to_top_up&&(input.val(need_to_top_up),message.text(`You will get ${(.1*need_to_top_up).toFixed(3).slice(0,-1)} bonuses`)),input.on("keyup change",(evt=>{message.text(`You will get ${(.1*parseFloat(evt.target.value)).toFixed(3).slice(0,-1)} bonuses`)}));const button=modal.body.find("#topup_button");button.click((()=>{input.val()&&(button.addClass("disabled"),modal.body.find(".paynocchio-spinner").toggleClass("active"),modal.body.find("#topup_message").text("Working..."),(0,_repository.handleTopUpClick)(input.val(),window.location.href).then((data=>{data.success?(modal.body.find("#topup_message").text("OK... Sending to Stripe..."),window.location.replace(data.url)):(modal.body.find(".paynocchio-spinner").toggleClass("active"),modal.body.find("#topup_message").text("There is an Error occurred. Please try again later."),button.toggleClass("disabled"))})))}))}))}))}}));

//# sourceMappingURL=wallet_topup.min.js.map