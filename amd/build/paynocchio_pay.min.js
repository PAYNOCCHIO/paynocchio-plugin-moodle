define("paygw_paynocchio/paynocchio_pay",["exports","./repository","core/notification","core/templates"],(function(_exports,_repository,_notification,_templates){var obj;
/**
   * Paynocchio repository module to encapsulate all of the AJAX requests that can be sent for bank.
   *
   * @module     paygw_paynocchio/repository
   * @copyright  2024 Paynocchio <ceo@paynocchio.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};const checkPayability=(value,fullAmount,balance,element)=>{parseFloat(value)+parseFloat(balance)<parseFloat(fullAmount)?(element.classList.add("disabled"),document.getElementById("topup_message").innerText="Please top up or use your Bonuses."):(element.classList.remove("disabled"),document.getElementById("topup_message").innerText="")};_exports.init=(component,paymentArea,itemid,fullAmount,balance)=>{const paynocchio_pay_button=document.getElementById("paynocchio_pay_button");if(paynocchio_pay_button){const range=document.getElementById("bonuses-range"),input=document.getElementById("bonuses-value");checkPayability(input.value,fullAmount,balance,paynocchio_pay_button),input.addEventListener("change",(()=>{range.value=input.value})),range.addEventListener("change",(()=>{input.value=range.value,checkPayability(input.value,fullAmount,balance,paynocchio_pay_button)})),range.addEventListener("input",(()=>{input.value=range.value,checkPayability(input.value,fullAmount,balance,paynocchio_pay_button)})),paynocchio_pay_button.addEventListener("click",(()=>{const bonuses=parseFloat(input.value),spinner=document.querySelector(".paynocchio-spinner"),topup_message=document.getElementById("topup_message");bonuses+balance<fullAmount?topup_message.innerText="Sorry, but no":(paynocchio_pay_button.classList.add("disabled"),spinner.classList.add("active"),(0,_repository.makePayment)(component,paymentArea,itemid,fullAmount,bonuses).then((data=>{data.success&&(spinner.classList.remove("active"),topup_message.innerText="Success",_templates.default.renderForPromise("paygw_paynocchio/enrolled_already",[]).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.replaceNodeContents(".paynocchio-profile-block",html,js)})).catch((error=>(0,_notification.exception)(error))))})))}))}}}));

//# sourceMappingURL=paynocchio_pay.min.js.map